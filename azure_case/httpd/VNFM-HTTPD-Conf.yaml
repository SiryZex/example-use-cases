tosca_definitions_version: cloudify_dsl_1_3

imports:
  - http://www.getcloudify.org/spec/cloudify/4.5/types.yaml
  - plugin:cloudify-utilities-plugin

inputs:
  httpd_vm_deployment_name:
    description: Name of HTTPD Provisioning deployment
    default: VNFM-HTTPD-Prov-Azure-vm

node_templates:
  node_impl:
    type: cloudify.terminal.raw
    interfaces:
      cloudify.interfaces.lifecycle:
        create:
          inputs:
            terminal_auth:
              user: { get_secret: httpd_username }
              ip: { get_capability: [{ get_input: httpd_vm_deployment_name }, vm_public_ip] }
              password: { get_secret: httpd_password }
              errors: []
            calls:
              - action: 'screen -dmS -X python3 -m http.server 8080'

